<div class="profile-wrapper">
    <div *ngIf="!person && !notFound" class="waiting">
        <br />
        <div class="preloader-wrapper active">
            <div class="spinner-layer">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
        <span><br /><br />Loading...</span>
    </div>

    <h4 class="grey-text center-align" *ngIf="notFound">
        <br />Something's coming. Ruuuuun!
    </h4>
    <div class="info-wrapper" *ngIf="person">
        <div>
            <img class="photo z-depth-1" [src]="person.imageUrl.split('=')[0] + '=480'" />
        </div>
        <div class="infobox bkg-white z-depth-1">
            <div class="info">
                <h3>
                    {{ person.firstName }} {{ person.lastName }}
                    <a *ngIf="isMyProfile()" class="modal-trigger tooltipped" href="#edit-about" [attr.data-position]="'bottom'" [attr.data-tooltip]="'Edit your about description'"><i class="material-icons small">edit</i></a>
                </h3>
                <parse-links class="about flow-text" [innerHtml]="person.about | parseLinks"></parse-links>
                <br />
                <div>
                    <a [routerLink]="['/messages/' + person.id]">
                        <div class="price waves-effect waves-light btn white-text bkg-red tooltipped" [attr.data-position]="'bottom'" [attr.data-tooltip]="'Open your messages with ' + person.firstName" *ngIf="!isMyProfile()">
                            <b>Message {{ person.firstName }}</b>
                        </div>
                    </a>
                    <div class="waves-effect waves-light btn white-text teal tooltipped" [attr.data-position]="'bottom'" [attr.data-tooltip]="'You\'ll get updates from ' + person.firstName + ' ' + person.lastName" *ngIf="!isMyProfile()" (click)="toggleFollow()">
                        <b *ngIf="!isFollowing">Follow</b>
                        <i *ngIf="isFollowing" class="material-icons">check</i>
                    </div>
                    <div *ngIf="person.infoFollowers" class="followers grey-text text-darken-2">{{ person.infoFollowers }} {{ person.infoFollowers === 1 ? 'follower' : 'followers' }}</div>
                </div>
            </div>
            <div class="tabs-anchor">
                <ul class="tabs">
                    <li class="tab"><a href="#tab-updates" (click)="selectTab('updates')" class="txt-red"><i class="material-icons">perm_identity</i> Updates</a></li>
                    <li *ngIf="person.offers && person.offers.length" class="tab"><a href="#tab-offers" (click)="selectTab('offers')" class="active txt-green"><i class="material-icons">redeem</i> Offers</a></li>
                    <li *ngIf="person.projects && person.projects.length" class="tab"><a href="#tab-projects" (click)="selectTab('projects')" class="deep-orange-text"> <i class="material-icons">settings</i> Projects</a></li>
                    <li *ngIf="person.resources && person.resources.length" class="tab"><a href="#tab-resources" (click)="selectTab('resources')" class="brown-text"> <i class="material-icons">language</i> Resources</a></li>
                    <li *ngIf="person.hubs && person.hubs.length" class="tab"><a href="#tab-hubs" (click)="selectTab('hubs')" class="blue-text"><i class="material-icons">room</i> Hubs</a></li>
                    <li *ngIf="person.clubs && person.clubs.length" class="tab"><a href="#tab-clubs" (click)="selectTab('clubs')" class="orange-text"><i class="material-icons">supervisor_account</i> Clubs</a></li>
                    <li *ngIf="person.people && person.people.length" class="tab"><a href="#tab-people" (click)="selectTab('people')" class="txt-red"><i class="material-icons">perm_identity</i> People</a></li>
                </ul>
            </div>
        </div>
    </div>
    <br />
    <div class="start-hidden" id="tab-updates">
        <thing-updates *ngIf="person" [updates]="person.updates"></thing-updates>
    </div>
    <div id="tab-offers">
        <offers *ngIf="person" [list]="offers" [profile]="isMyProfile()"></offers>
    </div>
    <div class="start-hidden" id="tab-projects">
        <things *ngIf="person" [things]="person.projects"></things>
    </div>
    <div class="start-hidden" id="tab-resources">
        <things *ngIf="person" [things]="person.resources"></things>
    </div>
    <div class="start-hidden" id="tab-hubs">
        <things *ngIf="person" [things]="person.hubs"></things>
    </div>
    <div class="start-hidden" id="tab-people">
        <things *ngIf="person" [things]="person.people"></things>
    </div>
    <div id="edit-about" class="modal">
        <div class="modal-content">
            <h4>Edit me</h4>
            <div class="input-field col s12">
                <i class="material-icons prefix">edit</i>
                <textarea id="editAbout" class="materialize-textarea" type="text" [(ngModel)]="editAbout" name="editAbout"></textarea>
                <label class="active" for="editAbout">Enter about</label>
            </div>
            <br />
            <div class="grey-text">
                Change your name and photo on <a href="https://aboutme.google.com" target="_blank">Google+</a>.
            </div>
        </div>
        <div class="modal-footer">
            <a class="right modal-action modal-close waves-effect waves- btn-flat blue-text" (click)="saveEdit()">Save</a>
            <a class="right modal-action modal-close waves-effect btn-flat grey-text">Nope</a>
        </div>
    </div>
</div>

<div class="fixed-action-btn" *ngIf="isMyProfile()">
    <a href="#postUpdateModal" class="btn-floating btn-large bkg-red tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Post an update'">
        <i class="large material-icons">add</i>
    </a>
    <ul>
        <li><a class="btn-floating purple tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a form'"><i class="material-icons">receipt</i></a></li>
        <li><a class="btn-floating orange tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a club'"><i class="material-icons">supervisor_account</i></a></li>
        <li><a class="btn-floating blue tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a hub'"><i class="material-icons">room</i></a></li>
        <li><a class="btn-floating brown tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a resource'"><i class="material-icons">language</i></a></li>
        <li><a class="btn-floating deep-orange tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a project'"><i class="material-icons">settings</i></a></li>
        <li><a class="btn-floating bkg-green tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add an offer'"><i class="material-icons">redeem</i></a></li>
        <li><a class="btn-floating bkg-red tooltipped" [attr.data-position]="'left'" [attr.data-tooltip]="'Add a member'"><i class="material-icons">perm_identity</i></a></li>
    </ul>
</div>